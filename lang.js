const translations = {
    zh: {
        title: "创造你完美的头像",
        subtitle: "通过 FaceLab，你可以生成独特的个性化头像",
        styleSelect: "风格选择",
        styles: {
            pixel: "像素风",
            geometric: "几何风"
        },
        colorTheme: "颜色主题",
        bgColor: "背景颜色",
        primaryColor: "主要颜色",
        customOptions: "自定义选项",
        complexity: "复杂度",
        rotation: "旋转角度",
        colorfulness: "色彩丰富度",
        generateBtn: "生成头像",
        randomize: "随机生成",
        download: "下载头像",
        randomColor: "随机颜色"
    },
    en: {
        title: "Create Your Perfect Avatar",
        subtitle: "Generate unique personalized avatars with FaceLab",
        styleSelect: "Style Selection",
        styles: {
            pixel: "Pixel",
            geometric: "Geometric"
        },
        colorTheme: "Color Theme",
        bgColor: "Background Color",
        primaryColor: "Primary Color",
        customOptions: "Custom Options",
        complexity: "Complexity",
        rotation: "Rotation",
        colorfulness: "Colorfulness",
        generateBtn: "Generate Avatar",
        randomize: "Randomize",
        download: "Download",
        randomColor: "Random Colors"
    },
    es: {
        title: "Crea Tu Avatar Perfecto",
        subtitle: "Genera avatares únicos y personalizados con FaceLab",
        styleSelect: "Selección de Estilo",
        styles: {
            pixel: "Pixel Art",
            geometric: "Geométrico"
        },
        colorTheme: "Tema de Color",
        bgColor: "Color de Fondo",
        primaryColor: "Color Primario",
        customOptions: "Opciones Personalizadas",
        complexity: "Complejidad",
        rotation: "Rotación",
        colorfulness: "Colorido",
        generateBtn: "Generar Avatar",
        randomize: "Aleatorio",
        download: "Descargar",
        randomColor: "Colores Aleatorios"
    },
    fr: {
        title: "Créez Votre Avatar Parfait",
        subtitle: "Générez des avatars uniques et personnalisés avec FaceLab",
        styleSelect: "Sélection du Style",
        styles: {
            pixel: "Pixel Art",
            geometric: "Géométrique"
        },
        colorTheme: "Thème de Couleur",
        bgColor: "Couleur de Fond",
        primaryColor: "Couleur Principale",
        customOptions: "Options Personnalisées",
        complexity: "Niveau de Complexité",
        rotation: "Angle de Rotation",
        generateBtn: "Générer l'Avatar",
        randomize: "Aléatoire",
        download: "Télécharger",
        randomColor: "Couleurs Aléatoires"
    },
    de: {
        title: "Erstellen Sie Ihren Perfekten Avatar",
        subtitle: "Generieren Sie einzigartige personalisierte Avatare mit FaceLab",
        styleSelect: "Stilauswahl",
        styles: {
            pixel: "Pixelkunst",
            geometric: "Geometrisch"
        },
        colorTheme: "Farbthema",
        bgColor: "Hintergrundfarbe",
        primaryColor: "Primärfarbe",
        customOptions: "Anpassungsoptionen",
        complexity: "Komplexitätsgrad",
        rotation: "Rotationswinkel",
        generateBtn: "Avatar Erstellen",
        randomize: "Zufällig",
        download: "Herunterladen",
        randomColor: "Zufällige Farben"
    },
    ja: {
        title: "あなただけのアバターを作成",
        subtitle: "FaceLabで独自のパーソナライズされたアバターを生成",
        styleSelect: "スタイル選択",
        styles: {
            pixel: "ピクセルアート",
            geometric: "ジオメトリック"
        },
        colorTheme: "カラーテーマ",
        bgColor: "背景色",
        primaryColor: "メインカラー",
        customOptions: "カスタマイズ",
        complexity: "複雑度レベル",
        rotation: "回転角度",
        generateBtn: "アバター生成",
        randomize: "ランダム",
        download: "ダウンロード",
        randomColor: "カラーをランダム"
    },
    ko: {
        title: "나만의 완벽한 아바타 만들기",
        subtitle: "FaceLab으로 독특한 맞춤형 아바타 생성",
        styleSelect: "스타일 선택",
        styles: {
            pixel: "픽셀 아트",
            geometric: "기하학적"
        },
        colorTheme: "색상 테마",
        bgColor: "배경색",
        primaryColor: "주요 색상",
        customOptions: "사용자 설정",
        complexity: "복잡도 수준",
        rotation: "회전 각도",
        generateBtn: "아바타 생성",
        randomize: "무작위",
        download: "다운로드",
        randomColor: "색상 무작위"
    },
    ru: {
        title: "Создайте Свой Идеальный Аватар",
        subtitle: "Создавайте уникальные персонализированные аватары с FaceLab",
        styleSelect: "Выбор Стиля",
        styles: {
            pixel: "Пиксельный",
            geometric: "Геометрический"
        },
        colorTheme: "Цветовая Тема",
        bgColor: "Цвет Фона",
        primaryColor: "Основной Цвет",
        customOptions: "Настройки",
        complexity: "Уровень Сложности",
        rotation: "Угол Поворота",
        generateBtn: "Создать Аватар",
        randomize: "Случайно",
        download: "Скачать",
        randomColor: "Случайные Цвета"
    },
    ar: {
        title: "أنشئ الصورة الرمزية المثالية",
        subtitle: "قم بإنشاء صور رمزية شخصية فريدة مع FaceLab",
        styleSelect: "اختيار النمط",
        styles: {
            pixel: "فن البكسل",
            geometric: "هندسي"
        },
        colorTheme: "نمط الألوان",
        bgColor: "لون الخلفية",
        primaryColor: "اللون الرئيسي",
        customOptions: "خيارات مخصصة",
        complexity: "مستوى التعقيد",
        rotation: "زاوية الدوران",
        generateBtn: "إنشاء الصورة",
        randomize: "عشوائي",
        download: "تحميل",
        randomColor: "ألوان عشوائية"
    },
    hi: {
        title: "अपना परफेक्ट अवतार बनाएं",
        subtitle: "FaceLab के साथ अनूठे व्यक्तिगत अवतार बनाएं",
        styleSelect: "स्टाइल चयन",
        styles: {
            pixel: "पिक्सेल आर्ट",
            geometric: "ज्यामितीय"
        },
        colorTheme: "रंग थीम",
        bgColor: "पृष्ठभूमि रंग",
        primaryColor: "प्राथमिक रंग",
        customOptions: "कस्टम विकल्प",
        complexity: "जटिलता स्तर",
        rotation: "घूर्णन कोण",
        generateBtn: "अवतार बनाएं",
        randomize: "रैंडम",
        download: "डाउनलोड",
        randomColor: "रंग यादृच्छिक करें"
    },
    pt: {
        title: "Crie Seu Avatar Perfeito",
        subtitle: "Gere avatares personalizados únicos com o FaceLab",
        styleSelect: "Seleção de Estilo",
        styles: {
            pixel: "Pixel Art",
            geometric: "Geométrico"
        },
        colorTheme: "Tema de Cores",
        bgColor: "Cor de Fundo",
        primaryColor: "Cor Primária",
        customOptions: "Opções Personalizadas",
        complexity: "Nível de Complexidade",
        rotation: "Ângulo de Rotação",
        generateBtn: "Gerar Avatar",
        randomize: "Aleatório",
        download: "Baixar",
        randomColor: "Cores Aleatórias"
    }
};

// 语言切换功能
class I18n {
    constructor(translations) {
        this.translations = translations;
        this.currentLang = localStorage.getItem('preferredLanguage') || 'zh';
    }

    init() {
        const customSelect = document.querySelector('.custom-select');
        const customOptions = document.querySelector('.custom-options');
        const selectedText = document.querySelector('.selected-text');
        const options = document.querySelectorAll('.custom-option');
        const selectedFlag = customSelect.querySelector('img');

        console.log('Elements found:', {
            customSelect,
            customOptions,
            selectedText,
            options: options.length,
            selectedFlag
        });

        // 点击显示/隐藏选项
        customSelect.addEventListener('click', (e) => {
            e.stopPropagation();
            const isVisible = customOptions.style.display === 'block';
            customOptions.style.display = isVisible ? 'none' : 'block';
            console.log('Language selector clicked, display:', customOptions.style.display);
        });

        // 点击选项时更新语言
        options.forEach(option => {
            option.addEventListener('click', (e) => {
                e.stopPropagation();
                const value = option.dataset.value;
                const text = option.querySelector('span').textContent;
                const flagSrc = option.querySelector('img').src;
                
                console.log('Language option clicked:', value);
                
                selectedText.textContent = text;
                selectedFlag.src = flagSrc;
                customOptions.style.display = 'none';
                
                this.changeLanguage(value);
            });
        });

        // 点击其他地方时关闭下拉菜单
        document.addEventListener('click', (e) => {
            if (!customSelect.contains(e.target)) {
                customOptions.style.display = 'none';
            }
        });

        // 初始化当前语言
        this.changeLanguage(this.currentLang);
    }

    changeLanguage(lang) {
        if (!this.translations[lang]) return;
        
        console.log('Changing language to:', lang);
        
        this.currentLang = lang;
        localStorage.setItem('preferredLanguage', lang);

        // 更新所有带有 data-i18n 属性的元素
        document.querySelectorAll('[data-i18n]').forEach(element => {
            const key = element.dataset.i18n;
            const translation = this.getNestedTranslation(this.translations[lang], key);
            
            if (translation) {
                element.textContent = translation;
                console.log('Updated element:', key, translation);
            }
        });

        // 更新页面标题
        document.title = `FaceLab - ${this.translations[lang].title}`;
    }

    getNestedTranslation(obj, path) {
        return path.split('.').reduce((prev, curr) => {
            return prev ? prev[curr] : null;
        }, obj);
    }
}

// 等待 DOM 完全加载后再初始化
document.addEventListener('DOMContentLoaded', () => {
    console.log('DOM loaded, initializing I18n');
    const i18n = new I18n(translations);
    i18n.init();
    window.i18n = i18n;
}); 